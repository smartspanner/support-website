<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- Preconnect to external domains for performance -->
  <link rel="preconnect" href="https://unpkg.com" crossorigin>
  <link rel="preconnect" href="https://www.youtube.com" crossorigin>
  <link rel="preconnect" href="https://www.google-analytics.com" crossorigin>
  
  <!-- DNS Prefetch for additional domains -->
  <link rel="dns-prefetch" href="https://www.youtube.com">
  <link rel="dns-prefetch" href="https://i.ytimg.com">
  
  <!-- Primary Meta Tags -->
  <title>{{ page.title }} | {{ site.title }}</title>
  <meta name="title" content="{{ page.title }} | {{ site.title }}">
  <meta name="description" content="{{ page.description | default: site.description }}">
  <meta name="author" content="{{ site.author }}">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="{{ page.url | absolute_url }}">
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="{% if page.url == '/' %}website{% else %}article{% endif %}">
  <meta property="og:url" content="{{ page.url | absolute_url }}">
  <meta property="og:title" content="{{ page.title }} | {{ site.title }}">
  <meta property="og:description" content="{{ page.description | default: site.description }}">
  <meta property="og:image" content="{{ '/assets/images/og-image.png' | absolute_url }}">
  <meta property="og:site_name" content="{{ site.title }}">
  <meta property="og:locale" content="en_GB">
  
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:url" content="{{ page.url | absolute_url }}">
  <meta name="twitter:title" content="{{ page.title }} | {{ site.title }}">
  <meta name="twitter:description" content="{{ page.description | default: site.description }}">
  <meta name="twitter:image" content="{{ '/assets/images/og-image.png' | absolute_url }}">
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23feb900'%3E%3Cpath d='M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z'/%3E%3C/svg%3E">
  <link rel="apple-touch-icon" href="{{ '/assets/images/apple-touch-icon.png' | relative_url }}">
  
  <!-- Critical CSS (inline for performance) -->
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    :root{--color-primary:#feb900;--bg-gradient-start:#0f172a;--bg-gradient-end:#1e293b;--sidebar-bg:rgba(15,23,42,.95);--text-primary:#fff;--text-muted:rgba(255,255,255,.7)}
    body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif;background:linear-gradient(135deg,var(--bg-gradient-start) 0%,var(--bg-gradient-end) 100%);min-height:100vh;color:var(--text-primary);line-height:1.6}
    .layout{display:flex;min-height:100vh}
    .sidebar{width:280px;background:var(--sidebar-bg);position:fixed;height:100vh;z-index:100}
    .main-content{flex:1;margin-left:280px;padding:2rem;min-height:100vh}
    @media(max-width:768px){.sidebar{transform:translateX(-100%)}.main-content{margin-left:0;padding:4rem 1rem 2rem}}
  </style>
  
  <!-- Main CSS (deferred loading) -->
  <link rel="preload" href="{{ '/assets/css/main.css' | relative_url }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="{{ '/assets/css/main.css' | relative_url }}"></noscript>
  
  <!-- Structured Data (JSON-LD) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "{{ site.title }}",
    "url": "{{ site.url }}",
    "description": "{{ site.description }}",
    "publisher": {
      "@type": "Organization",
      "name": "Smartspanner Ltd",
      "url": "https://www.smartspanner.com",
      "logo": {
        "@type": "ImageObject",
        "url": "{{ '/assets/images/smartspanner-logo.png' | absolute_url }}"
      }
    },
    "potentialAction": {
      "@type": "SearchAction",
      "target": "{{ site.url }}/?q={search_term_string}",
      "query-input": "required name=search_term_string"
    }
  }
  </script>
  {% if page.url != '/' %}
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "TechArticle",
    "headline": "{{ page.title }}",
    "description": "{{ page.description | default: site.description }}",
    "url": "{{ page.url | absolute_url }}",
    "author": {
      "@type": "Organization",
      "name": "Smartspanner Ltd"
    },
    "publisher": {
      "@type": "Organization",
      "name": "Smartspanner Ltd",
      "logo": {
        "@type": "ImageObject",
        "url": "{{ '/assets/images/smartspanner-logo.png' | absolute_url }}"
      }
    },
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "{{ page.url | absolute_url }}"
    },
    "about": {
      "@type": "SoftwareApplication",
      "name": "Smartspanner CMMS",
      "applicationCategory": "BusinessApplication",
      "operatingSystem": "Web, iOS, Android"
    }
  }
  </script>
  {% endif %}
  
  <!-- Breadcrumb structured data -->
  {% if page.section %}
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      {
        "@type": "ListItem",
        "position": 1,
        "name": "Home",
        "item": "{{ site.url }}"
      },
      {
        "@type": "ListItem",
        "position": 2,
        "name": "{{ page.section }}",
        "item": "{{ site.url }}"
      },
      {
        "@type": "ListItem",
        "position": 3,
        "name": "{{ page.title }}",
        "item": "{{ page.url | absolute_url }}"
      }
    ]
  }
  </script>
  {% endif %}
  
  {% seo %}
</head>
<body>
  <button class="mobile-menu-btn" onclick="toggleMobileMenu()" aria-label="Toggle navigation menu">
    <i data-lucide="menu" class="icon"></i>
  </button>
  <div class="layout">
    {% include sidebar.html %}
    <main class="main-content" role="main">
      <article class="content-wrapper">
        {{ content }}
      </article>
    </main>
  </div>
  
  <!-- Defer non-critical JavaScript -->
  <script src="https://unpkg.com/lucide@latest" defer></script>
  <script src="{{ '/assets/js/main.js' | relative_url }}" defer></script>
  
  <!-- Initialize Lucide after load -->
  <script>
    window.addEventListener('load', function() {
      if (typeof lucide !== 'undefined') {
        lucide.createIcons();
      }
    });
  </script>
</body>
</html>
